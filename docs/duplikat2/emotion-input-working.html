<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <title>Emotion Input - TeamPulse</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/emotion-input.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Load TensorFlow.js and face-api.js with versions known to work well together -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.7.4/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2>TeamPulse</h2>
                <button id="sidebarClose" class="sidebar-close" aria-label="Close sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav>
                <ul>
                    <li><a href="dashboard.html"><i class="fas fa-tachometer-alt"></i>Dashboard</a></li>
                    <li><a href="emotion-input.html" class="active"><i class="fas fa-camera"></i>Emotion Input</a></li>
                    <li><a href="history.html"><i class="fas fa-history"></i>History</a></li>
                    <li><a href="feedback.html"><i class="fas fa-comments"></i>Feedback</a></li>
                    <li><a href="settings.html"><i class="fas fa-cog"></i>Settings</a></li>
                    <li><a href="index.html"><i class="fas fa-sign-out-alt"></i>Logout</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Mobile Menu Toggle -->
        <button id="menuToggle" class="menu-toggle" aria-label="Toggle navigation menu">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar Overlay -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- Main Content Area -->
        <div class="content-area">
            <div class="main-content">
                <!-- Section Header -->
                <div class="section-header">
                    <h2>Emotion Input & Analysis</h2>
                    <p>Capture and analyze emotions through facial expressions and voice</p>
                </div>

                <!-- Input Methods Tabs -->
                <div class="input-tabs">
                    <button class="tab-btn active" data-tab="camera">
                        <i class="fas fa-camera"></i>
                        Camera Detection
                    </button>
                    <button class="tab-btn" data-tab="audio">
                        <i class="fas fa-microphone"></i>
                        Audio Analysis
                    </button>
                    <button class="tab-btn" data-tab="text">
                        <i class="fas fa-keyboard"></i>
                        Text Input
                    </button>
                </div>

                <!-- Camera Input Section -->
                <div class="input-section active" id="camera-section">
                    <div class="input-card">
                        <div class="card-header">
                            <h3>Facial Expression Analysis</h3>
                            <p>Position your face in the camera view for emotion detection</p>
                        </div>
                        <div class="card-body">
                            <div class="media-container">
                                <video id="video" width="640" height="480" autoplay muted></video>
                                <canvas id="canvas" width="640" height="480"></canvas>
                                <div class="detection-overlay" id="detectionOverlay">
                                    <div class="detection-box" id="detectionBox"></div>
                                </div>
                            </div>
                            <div class="controls">
                                <button id="startCamera" class="btn btn-primary">
                                    <i class="fas fa-play"></i>
                                    Start Camera
                                </button>
                                <button id="captureEmotion" class="btn btn-secondary" disabled>
                                    <i class="fas fa-camera"></i>
                                    Capture Emotion
                                </button>
                                <button id="stopCamera" class="btn btn-outline" disabled>
                                    <i class="fas fa-stop"></i>
                                    Stop Camera
                                </button>
                            </div>
                            <div class="status-message" id="cameraStatus">
                                Click "Start Camera" to begin facial emotion detection
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Audio Input Section -->
                <div class="input-section" id="audio-section">
                    <div class="input-card">
                        <div class="card-header">
                            <h3>Voice Emotion Analysis</h3>
                            <p>Speak to analyze emotional tone and sentiment</p>
                        </div>
                        <div class="card-body">
                            <div class="audio-container">
                                <div class="audio-visualizer" id="audioVisualizer">
                                    <canvas id="audioCanvas" width="600" height="200"></canvas>
                                </div>
                                <div class="audio-controls">
                                    <button id="startRecording" class="btn btn-primary">
                                        <i class="fas fa-microphone"></i>
                                        Start Recording
                                    </button>
                                    <button id="stopRecording" class="btn btn-secondary" disabled>
                                        <i class="fas fa-stop"></i>
                                        Stop Recording
                                    </button>
                                    <button id="playRecording" class="btn btn-outline" disabled>
                                        <i class="fas fa-play"></i>
                                        Play Recording
                                    </button>
                                </div>
                                <div class="recording-status" id="recordingStatus">
                                    Click "Start Recording" to begin voice analysis
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Text Input Section -->
                <div class="input-section" id="text-section">
                    <div class="input-card">
                        <div class="card-header">
                            <h3>Text Emotion Analysis</h3>
                            <p>Enter text to analyze emotional content and sentiment</p>
                        </div>
                        <div class="card-body">
                            <div class="text-input-container">
                                <div class="form-group">
                                    <label for="emotionText" class="form-label">Describe your current emotion or mood:</label>
                                    <textarea id="emotionText" class="form-textarea" rows="6" 
                                        placeholder="How are you feeling today? Describe your emotions, mood, or any specific feelings you're experiencing..."></textarea>
                                </div>
                                <div class="text-controls">
                                    <button id="analyzeText" class="btn btn-primary">
                                        <i class="fas fa-brain"></i>
                                        Analyze Text
                                    </button>
                                    <button id="clearText" class="btn btn-outline">
                                        <i class="fas fa-eraser"></i>
                                        Clear Text
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="results-section" id="resultsSection" style="display: none;">
                    <div class="results-card">
                        <div class="card-header">
                            <h3>Emotion Analysis Results</h3>
                            <button id="closeResults" class="btn btn-sm btn-outline">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="results-grid">
                                <div class="result-item">
                                    <h4>Primary Emotion</h4>
                                    <div class="emotion-display" id="primaryEmotion">
                                        <span class="emotion-icon">ðŸ˜Š</span>
                                        <span class="emotion-label">Happy</span>
                                    </div>
                                </div>
                                <div class="result-item">
                                    <h4>Confidence Level</h4>
                                    <div class="confidence-meter">
                                        <div class="progress">
                                            <div class="progress-bar" id="confidenceBar" style="width: 85%"></div>
                                        </div>
                                        <span class="confidence-text" id="confidenceText">85%</span>
                                    </div>
                                </div>
                                <div class="result-item">
                                    <h4>Mood Score</h4>
                                    <div class="mood-score" id="moodScore">8.5/10</div>
                                </div>
                                <div class="result-item">
                                    <h4>Stress Level</h4>
                                    <div class="stress-indicator" id="stressIndicator">Low</div>
                                </div>
                            </div>
                            <div class="emotion-breakdown">
                                <h4>Emotion Breakdown</h4>
                                <div class="emotion-bars" id="emotionBars">
                                    <!-- Emotion bars will be populated by JavaScript -->
                                </div>
                            </div>
                            <div class="action-buttons">
                                <button id="saveEmotion" class="btn btn-success">
                                    <i class="fas fa-save"></i>
                                    Save Emotion
                                </button>
                                <button id="newAnalysis" class="btn btn-primary">
                                    <i class="fas fa-plus"></i>
                                    New Analysis
                                </button>
                                <button id="shareResults" class="btn btn-outline">
                                    <i class="fas fa-share"></i>
                                    Share Results
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/sidebar.js"></script>
    <script src="js/emotion-input-simple.js"></script>
</body>
</html>
